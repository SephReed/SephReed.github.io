<!DOCTYPE html>
<html>
<head>
	<title>Flame FX</title>

	<!-- Globals -->
	<script type="text/javascript">
		let modals; 	// modals overlay
		let fx; 			// flame fx manager
		const BOOSH_SETUP = [
			{x:74, y:170},
			{x:242, y:126},
			{x:396, y:100},
			{x:562, y:100},
			{x:718, y:126},
			{x:886, y:170},
		];
	</script>

	<!-- External Dependencies -->
	<script type="text/javascript" src="external/easyElement.js"></script>
	<!-- <script type="text/javascript" src="external/import.js"></script> -->
	<script type="text/javascript" src="external/hsvTool.js"></script>

	<!-- Class Heirarchy -->
	<script type="text/javascript" src="Class_FlameFX.js"></script>

	<script type="text/javascript" src="Class_PatternSelector.js"></script>
	<script type="text/javascript" src="Patterns/Class_BatchSet.js"></script>

	<script type="text/javascript" src="Class_Modals.js"></script>
	
	<!-- Init-->
	<script type="text/javascript">
		fx = new FlameFX(BOOSH_SETUP);
		modals = new Modals();

		document.addEventListener("DOMContentLoaded", () => {
			fx.ownDomNode(El.byTag("preview"));
			fx.ownPreviewCanvas(El.byID("preveiw_canvas"));
			fx.ownGasUsesDomNode(El.byTag("gas-use"));
			PATTERN_SELECTOR.ownDomNode(El.byTag("pattern-list"));
			modals.ownDomNode(El.byTag("modals"));
		});

	</script>
	<style>
		:root {
			--foreground: #FFF;
			--lightest: #666;
			--lighter: #555;
			--light: #444;
			--background: #333;
			--dark: #222;
			--darker: #111;
			--darkest: #000;

			--outset-1: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
			--outset-2: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
		}

		body, html {
			height: 100vh;
			width: 100vw;
			padding: 0px;
			margin: 0px;
			box-sizing: border-box;
			overflow: hidden;
		}

		*, *::before, *::after {
			box-sizing: inherit;
		}

		body {
			background-color: var(--background);
			font-family: arial;
			color: var(--foreground);
		}

			content {
				display: flex;
				height: 100%;
				width: 100%;
				flex-direction: column;
			}

				topbar {
					position: relative;
					z-index: 2;
					display: block;
					height: 30px;
					background-color: var(--dark);
					border-bottom: 3px solid var(--darker);
					box-shadow: var(--outset-2);
				}

				workspace {
					position: relative;
					display: flex;
					flex-direction: row;
					flex: 1;
				}

					preview {
						position: relative;
						display: flex;
						flex-direction: column;
						flex: 1;	
					}
						preview::after {
							display: block;
							content: "";
							position: absolute;
							z-index: -1;
							top: 0px;
							height: 100%;
							width: 100%;
							background-color: var(--dark);
							background-size: 50px 20px;
							background-image: url("public/grid.png");
							opacity: 0.02;
						}

						canvas {
							/*height: 100%;*/
							width: 100%;
							background-image: url("public/effigy_white_transparent.png");

							background-size: contain;
						}

						gas-use {
							display: flex;
							flex-direction: row;
							flex: 1;
							background-color: var(--dark);
							text-align: center;
							padding: 10px 2px 10px 2px;
						}

							accumulator {
								display: flex;
								position: relative;
								bottom: 0px;
								flex-direction: column;
								flex: 1;
							}
								gas-meter-container {
									display: inline-block;
									position: relative;
									text-align: center;
									flex: 1;
									margin: 10px 0px;
								}

									gas-meter {
										display: inline-block;
										position: absolute;
										bottom: 0px;
										width: 20%;
										height: 50%;
										background-color: red;
										transform: translate(-50%, 0%);
									}

										/*gas-meter::after {
											display: block;
											content: "";
											position: absolute;
											top: 0px;
											left: 0px;
											width: 100%;
											height: 100%;
											border: 1px solid white;
											opacity: 0.5;
										}*/

					commands {
						position: relative;
						z-index: 1;
						display: flex;
						flex-direction: column;
						background-color: var(--light);
						flex: 1;
						box-shadow: var(--outset-1);
						
					}

						options {
							display: block;
							background-color: var(--lighter);
							border-bottom: solid 3px var(--lightest);
						}

						command-list {
							display: block;
							flex: 1;
							overflow: scroll;
						}

		modals {
			display: block;
			position: fixed;
			top: 0px;
			left: 0px;
			right: 0px;
			bottom: 0px;	
			z-index: 2;		
			pointer-events: none;
		}

			modals > * {
				display: none;
				position: absolute;
				left: 50%;
				top: 50%;
				transform: translate(-50%, 50%);
				background-color: red;
			}



	</style>
</head>
<body>
	<content>
		<topbar>
		</topbar>
		<workspace>
			<preview>
				<canvas id="preveiw_canvas" width="991" height="505"></canvas>
				<gas-use></gas-use>
			</preview>
			<commands>
				<options>
					<button onclick="modals.showOrHide('pattern-chooser')">+</button>
				</options>
				<command-list></command-list>
			</commands>
		</workspace>
	</content>
	<modals>
		<pattern-chooser>
			<h1>Add new Pattern:</h1>
			<pattern-list></pattern-list>
		</pattern-chooser>
	</modals>
</body>

<head>

</head>
</html>